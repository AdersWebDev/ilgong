<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>건물 상세</title>
    <link rel="stylesheet" href="/main/style.css">
    <link rel="stylesheet" href="/aders/dashboard/building/static/building.css">
    <link rel="icon" href="../../../assest/favicon.png" type="image/png" />
</head>

<body>
    <div class="page-container">
        <div class="page-header">
            <h1 class="page-title" id="buildingTitle">건물 상세</h1>
            <a class="back-link" href="/aders/dashboard/building">← 목록으로</a>
        </div>

        <div id="detailLoading" class="detail-loading">로딩 중...</div>
        <div id="detailError" class="detail-error" style="display:none;"></div>

        <div id="detailContent" style="display:none;">
            <div class="detail-panel-nav">
                <button type="button" class="btn-panel-nav" id="detailPanelPrev">←</button>
                <div class="detail-panel-nav-title" id="detailPanelNavTitle">건물 상세</div>
                <button type="button" class="btn-panel-nav" id="detailPanelNext">→</button>
            </div>

            <div class="detail-panels" id="detailPanels" data-panel="1">
                <div class="detail-panels-track">
                    <!-- Panel 0: 건물 종합평가 -->
                    <div class="detail-panel">
                        <section class="detail-section">
                            <h2 class="detail-section-title">건물 종합평가</h2>
                            <textarea id="buildingOverallEvaluation" class="form-textarea" placeholder="추후 구현 예정" rows="10"></textarea>
                        </section>
                    </div>

                    <!-- Panel 1: 건물 상세 -->
                    <div class="detail-panel">
                        <form id="buildingForm">
                            <div class="detail-form-grid">
                                <section class="detail-section detail-section-basic">
                                    <h2 class="detail-section-title">기본 정보</h2>
                                    <div class="form-group">
                                        <label class="form-label" for="buildingName">건물명</label>
                                        <input type="text" id="buildingName" name="buildingName" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="address">주소</label>
                                        <input type="text" id="address" name="address" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="constructionDate">건축일</label>
                                        <input type="date" id="constructionDate" name="constructionDate" class="form-input" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="structure">구조</label>
                                        <select id="structure" name="structure" class="form-input" required>
                                            <option value="">선택</option>
                                            <option value="CONCRETE">철근·콘크리트 계열</option>
                                            <option value="STEEL">철골 계열</option>
                                            <option value="OTHER">기타 계열(목조 등)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="lat">위도</label>
                                        <input type="number" id="lat" name="lat" class="form-input" step="any" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="lng">경도</label>
                                        <input type="number" id="lng" name="lng" class="form-input" step="any" required>
                                    </div>
                                    <div class="form-group col">
                                        <label class="form-label">대표 사진 (편집용)</label>
                                        <div class="list-photo-wrap">
                                            <img id="listPhotoImg" src="" alt="대표 사진" class="list-photo-img" style="display: none;">
                                        </div>
                                        <div class="list-photo-upload">
                                            <input type="file" id="listPhotoInput" accept=".jpg,.jpeg,image/jpeg" title="대표 사진 업로드">
                                            <span class="list-photo-upload-label" id="listPhotoUploadLabel">파일 선택</span>
                                        </div>
                                        <input type="hidden" id="listPhoto" name="photo" value="">
                                    </div>
                                </section>

                                <section class="detail-section detail-section-facilities">
                                    <h2 class="detail-section-title">기본 분류</h2>
                                    <div class="classification-buttons" id="buildingClassification" role="group" aria-label="기본 분류">
                                        <button type="button" class="classify-btn" data-key="allowForeigner" aria-pressed="false">외국인 가능</button>
                                        <button type="button" class="classify-btn" data-key="allowWorkingHoliday" aria-pressed="false">워킹홀리데이 가능</button>
                                    </div>

                                    <div class="detail-subtitle">건물 설비</div>
                                    <div class="facility-grid" id="buildingFacilities"></div>
                                </section>

                                <section class="detail-section detail-section-transit">
                                    <h2 class="detail-section-title">교통 정보</h2>
                                    <div class="form-group">
                                        <label class="form-label" for="trans1">교통 1</label>
                                        <input type="text" id="trans1" name="trans1" class="form-input" placeholder="예: 今宮駅 徒歩5分">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="trans2">교통 2</label>
                                        <input type="text" id="trans2" name="trans2" class="form-input">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="trans3">교통 3</label>
                                        <input type="text" id="trans3" name="trans3" class="form-input">
                                    </div>
                                </section>

                                <section class="detail-section detail-section-photos">
                                    <h2 class="detail-section-title">건물 사진 <span style="font-size: var(--font-size-xs); color: var(--text-secondary);">(드래그로 순서변경)</span></h2>
                                    <div class="ilgong-photo-list-wrap">
                                        <div class="photo-list" id="ilgongPhotoList"></div>
                                        <div class="photo-add" id="ilgongPhotoAdd" title="사진 추가">
                                            <input type="file" id="ilgongPhotoInput" accept=".jpg,.jpeg,image/jpeg" multiple>
                                            + 추가
                                        </div>
                                    </div>
                                    <h2 class="detail-section-title">제공사 사진 <span style="font-size: var(--font-size-xs); color: var(--text-secondary);">(변경불가)</span></h2>
                                    <div class="photo-list photo-list-readonly" id="buildingPhotoList" aria-label="기존 건물 사진 (읽기 전용)"></div>
                                </section>

                                <section class="detail-section detail-section-rooms">
                                    <h2 class="detail-section-title">호실 (호실명 + 사진)</h2>
                                    <div class="room-accordion" id="roomAccordion"></div>
                                </section>
                            </div>

                            <div class="form-actions form-actions-inline" aria-hidden="true">
                                <button type="button" class="btn-secondary" id="cancelBtn">취소</button>
                                <button type="submit" class="btn-primary" id="saveBtn">저장</button>
                            </div>
                        </form>
                    </div>

                    <!-- Panel 2: 자료 검수 -->
                    <div class="detail-panel">
                        <section class="fact-view" aria-label="팩트 검수">
                            <div class="fact-left-panel">
                                <div class="fact-document-viewer" id="factDocumentViewer">
                                    <div class="fact-placeholder">문서가 여기에 표시됩니다.</div>
                                </div>
                            </div>

                            <div class="fact-right-panel">
                                <div class="fact-header-info">
                                    <div>
                                        <div class="fact-building-name" id="factBuildingName">건물명</div>
                                        <div class="fact-management-company" id="factManagementCompany">관리회사명</div>
                                    </div>
                                    <button type="button" class="fact-close-button" id="factCloseButton" title="닫기">×</button>
                                </div>

                                <div class="fact-hint" id="factHint" style="display:none;"></div>

                                <div class="fact-tab-container" role="tablist" aria-label="팩트 탭">
                                    <button type="button" class="fact-tab-button active" id="factInitialCostTab" data-tab="initialCost" role="tab" aria-selected="true">초기 상세비용</button>
                                    <button type="button" class="fact-tab-button" id="factSpecialTermsTab" data-tab="specialTerms" role="tab" aria-selected="false">특약 조건</button>
                                </div>

                                <div class="fact-text-area-container">
                                    <textarea class="fact-text-area" id="factContentTextArea" placeholder="내용을 입력하세요"></textarea>
                                </div>

                                <div class="fact-button-container">
                                    <button type="button" class="btn-secondary" id="factRejectButton">반려</button>
                                    <button type="button" class="btn-primary" id="factApproveButton">저장 및 승인</button>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
            <div class="detail-floating-actions" id="detailFloatingActions" aria-label="저장 작업">
                <button type="button" class="btn-secondary" id="floatingCancelBtn" style="width: 200px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">취소</button>
                <button type="submit" form="buildingForm" class="btn-primary" id="floatingSaveBtn" style="width: 200px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">저장</button>
            </div>
        </div>
    </div>

    <!-- 저장 전 변경점 확인 모달 (GitHub-style) -->
    <div id="saveDiffModal" class="diff-modal" style="display:none;" aria-hidden="true">
        <div class="diff-modal-backdrop" data-close="true"></div>
        <div class="diff-modal-card" role="dialog" aria-modal="true" aria-labelledby="saveDiffTitle">
            <div class="diff-modal-header">
                <div>
                    <div class="diff-modal-title" id="saveDiffTitle">변경 사항 확인</div>
                    <div class="diff-modal-subtitle" id="saveDiffSubtitle">변경 사항을 불러오는 중...</div>
                </div>
                <button type="button" class="diff-modal-close" id="saveDiffCloseBtn" aria-label="닫기">×</button>
            </div>
            <div class="diff-modal-body" id="saveDiffBody"></div>
            <div class="diff-modal-footer">
                <button type="button" class="btn-secondary" id="saveDiffCancelBtn">닫기</button>
                <button type="button" class="btn-primary" id="saveDiffConfirmBtn" disabled>최종 저장</button>
            </div>
        </div>
    </div>

    <script src="/aders/dashboard/building/static/detail.shared.js"></script>
    <script src="/aders/dashboard/building/static/detail.panels.js"></script>
    <script src="/aders/dashboard/building/static/detail.building.js"></script>
    <script src="/aders/dashboard/building/static/detail.rooms.js"></script>
    <script src="/aders/dashboard/building/static/detail.fact.js"></script>
    <script src="/aders/dashboard/building/static/detail.overall.js"></script>
    <script src="/aders/dashboard/building/static/detail.js"></script>
</body>

</html>

